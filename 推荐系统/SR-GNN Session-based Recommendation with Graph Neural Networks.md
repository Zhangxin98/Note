> **Title：**[Session-based Recommendation with Graph Neural Networks](https://arxiv.org/pdf/1811.00855.pdf)
>
> **Author：**Shu Wu, Yuyuan Tang, Yanqiao Zhu,  Liang Wang,  Xing Xie, Tieniu Tan
>
> 来自于AAAI19,  主要来自中科院，SR-GNN经常是其他的baseline。
>
> 后续有一篇论文 [GC-SAN](https://blog.csdn.net/hhmy77/article/details/117412390) 是SR-GNN 的改进版本，两篇论文的思路、框架都非常相似，发表在IJCAI 19
>
> 参考资料：[SR-GNN 论文阅读](https://zhuanlan.zhihu.com/p/376811872)
>
> 代码：[SR-GNN代码](https://zhuanlan.zhihu.com/p/374403316)

## 背景

SR-GNN是中科院提出的一种 基于会话序列建模的推荐系统，这里所谓的会话是指用户的交互过程（每个会话表示一次用户行为和对应的服务，所以每个用户记录都会构建成一张图），这里说的会话序列应该是专门表示一个用户过往一段时间的交互序列。 基于会话的推荐是现在比较常用的一种推荐方式，比较常用的会话推荐包括 循环神经网络、马尔科夫链。但是这些常用的会话推荐方式有以下的两个缺点：

* 当一个会话中用户的行为数量十分有限时【就是比较少时】，这种方法较难捕获用户的行为表示。比如使用RNN神经网络进行会话方式的推荐建模时，如果前面时序的动作项较少，会导致最后一个输出产生推荐项时，推荐的结果并不会怎么准确。
* 根据以往的工作发现，物品之前的转移模式在会话推荐中是十分重要的特征，但RNN和马尔科夫过程只对相邻的两个物品的单项转移向量进行 建模，而忽略了会话中其他的物品。【意思是RNN那种方式缺乏整体大局观，只构建了单项的转移向量，对信息的表达能力不够强】

## 架构

![image-20220315214537023](https://cdn.jsdelivr.net/gh/Zhangxin98/Note@main/img/image-20220315214537023.png)

* 最左侧是我们应该输入的数据，每一行表示一个用户进行 物品点击的记录，v表示物品，对于每一行数据可以表示为一个会话 ,我们的目的是根据这样的用户点击序列，来预测用户下一个要点击的物品 

* 基于每个session去构建一个子图，注意是每个用户的历史情况都会构建成一个图。
* 使用GNN网络对图进行信息的抽取挖掘，训练好GNN后，我们可以获取session图中每个点击物品的embedding_1向量化表示 [v1,v2,...,vn]，其中每个Vi都是一个向量，对应图框中的结果。
* 对于获得的每个物品的 向量化表示，实际上只有最后一个时刻物品是比较重要的【最后一次最能体现当前时间用户的兴趣】，我们单独将其取出为s1，而其他的信息，我们也会加以利用，但是是使用一种注意力分配的机制，添加了attention策略，根据前面几个物品跟最后一次点击的相似度，来进行注意力权值的附加，然后将这些最后一次之间的信息附加权重后加在一起，成为向量sg。
* 最后一步是先对s1和sg进行横向拼接，并进行线性变换，得到结果sh，最后将sh与每个物品的embedding进行内积计算【这里的embedding和经过GNN网络获取到的embedding_1是有所不同的，是每个物品初始的embedding,在经过GNN处理前已经决定了，是GNN网络的初始输入】，并通过softmax包装获取得到对应不同物品的点击概率，根据概率的大小绝对最后的推荐物品。



在文中使用的GNN是**Gated GNN**，