> 代码位置：G:\Code\GNN_02（G:\Code\GNN_01是处理数据）



## 数据处理

数据最终处理成3621个节点，7060条边，特征选取的subjectarea+keywords的词然后用bert产生词向量，相加求平均，768维，（可以加上toparea和topkeyword，onehot后concat之前的768维向量）

处理好的数据打包成了pkl文件，是一个pandas的dataframe（all_info_final.pkl和nodes.pkl）

## 实验数据

60%: train	20%: validation	20%:test 

### 基准算法

#### MLP

隐藏层大小64，六层的MLP训练100轮测试集准确率0.8430，说明特征是可以的     lr=0.005

#### GCN

| GCN层数 | 迭代次数epochs | 测试集准确率 | 训练集准确率 |
| :-----: | :------------: | :----------: | :----------: |
|    2    |      100       |    0.7906    |              |
|    2    |      200       |    0.8099    |              |
|    2    |      400       |    0.7989    |    0.7659    |
|    2    |      1000      |    0.7824    |    0.8450    |
|    1    |      100       |    0.7851    |              |
|    1    |      200       |    0.7769    |              |
|    1    |      400       |    0.7631    |              |
|    1    |      1000      |    0.7689    |              |
|    3    |      100       |    0.7741    |              |
|    3    |      200       |    0.7576    |              |
|    3    |      400       |    0.7658    |              |



#### GAT

| GAT层数 | heads | 迭代次数epochs | 测试集准确率 | 训练集准确率 |
| :-----: | :---: | :------------: | :----------: | :----------: |
|    2    |   8   |      100       |    0.8154    |    0.5449    |
|         |       |      200       |    0.8237    |    0.5601    |
|         |       |      400       |    0.8237    |    0.5742    |
|         |       |      1000      |    0.8237    |    0.5729    |
|         |   4   |      100       |    0.8264    |    0.5142    |
|         |       |      200       |    0.8292    |    0.5325    |
|         |       |      400       |    0.8320    |    0.5397    |
|         |       |      1000      |    0.8209    |    0.5218    |
|         |       |      800       |    0.8292    |    0.5511    |
|         |       |      600       |    0.8237    |    0.5376    |
|    3    | 8, 4  |      100       |    0.8264    |    0.4461    |
|         |       |      200       |    0.8320    |    0.4972    |
|         |       |      400       |    0.8237    |    0.5311    |
|         |       |      1000      |    0.8127    |    0.5325    |

#### GATv2

| GATv2层数 | heads | 迭代次数epochs | 测试集准确率 | 训练集准确率 |
| :-------: | :---: | :------------: | :----------: | :----------: |
|     2     |   8   |      1500      |    0.8320    |              |
|           |       |      1200      |    0.8402    |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |
|           |       |                |              |              |

### DeepGNNS

#### JKNET

| JKNET层数 | MODE | 迭代次数epochs | 测试集准确率 | 训练集准确率 |
| :-------: | ---- | :------------: | :----------: | :----------: |
|     6     | max  |      100       |    0.8485    |    0.4637    |
|           |      |      200       |    0.8375    |    0.5114    |
|           |      |      400       |    0.8320    |    0.5556    |
|     6     | cat  |      100       |    0.8044    |    0.7379    |
|           |      |      200       |    0.7961    |    0.7807    |
|           |      |      400       |    0.8264    |    0.8139    |
|           |      |      1000      |    0.7851    |    0.8453    |
|    10     | cat  |      100       |    0.7824    |    0.7334    |
|           |      |      200       |    0.8072    |    0.7700    |
|           |      |      400       |    0.7603    |    0.7914    |
|           | max  |      100       |    0.8292    |    0.6150    |
|           |      |      200       |    0.8209    |    0.6506    |
|           |      |      400       |    0.8485    |    0.6806    |
|           |      |      1000      |    0.8099    |    0.7086    |

#### JKNETATT

| JKNET层数 | MODE | 迭代次数epochs | 测试集准确率 | 训练集准确率 |
| :-------: | ---- | :------------: | :----------: | :----------: |
|     6     | MAX  |      100       |    0.8567    |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |
|           |      |                |              |              |

#### APPNP

| 层数K | alpha | 迭代次数epochs | 测试集准确率 | 训练集准确率 |
| :---: | ----- | :------------: | :----------: | :----------: |
|   6   | 0.1   |      100       |    0.8072    |    0.6502    |
|       |       |      200       |    0.8099    |    0.6716    |
|       |       |      400       |    0.7934    |    0.6830    |
|       | 0.2   |      400       |    0.8072    |    0.6937    |
|       |       |      200       |    0.8209    |    0.6868    |
|       |       |      100       |    0.8072    |    0.6581    |
|       | 0.4   |      100       |    0.8237    |    0.6588    |
|       |       |      200       |    0.8292    |    0.6951    |
|       |       |      400       |    0.7989    |    0.7055    |
|       | 0.5   |      100       |    0.8430    |    0.6571    |
|       |       |      200       |    0.8375    |    0.6834    |
|       | 0.6   |      100       |    0.8347    |    0.6461    |
|       |       |      200       |    0.8375    |    0.6785    |
|       | 0.8   |      100       |    0.8209    |    0.6205    |
|       |       |      200       |    0.8292    |    0.6430    |
|  10   | 0.1   |      100       |    0.7906    |    0.6616    |
|       |       |      200       |    0.7961    |    0.6765    |
|       | 0.2   |      100       |    0.8127    |    0.6588    |
|       |       |      200       |    0.8209    |    0.6875    |
|       | 0.4   |      100       |    0.8237    |    0.6585    |
|       |       |      200       |    0.8292    |    0.6927    |
|       | 0.5   |      200       |    0.8375    |    0.6827    |

#### 

